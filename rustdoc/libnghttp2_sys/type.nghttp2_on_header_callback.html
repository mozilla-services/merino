<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="@functypedef"><meta name="keywords" content="rust, rustlang, rust-lang, nghttp2_on_header_callback"><title>nghttp2_on_header_callback in libnghttp2_sys - Rust</title><link rel="stylesheet" type="text/css" href="../normalize.css"><link rel="stylesheet" type="text/css" href="../rustdoc.css" id="mainThemeStyle"><link rel="stylesheet" type="text/css" href="../light.css"  id="themeStyle"><link rel="stylesheet" type="text/css" href="../dark.css" disabled ><link rel="stylesheet" type="text/css" href="../ayu.css" disabled ><script id="default-settings" ></script><script src="../storage.js"></script><script src="../crates.js"></script><script defer src="../main.js"></script>
    <noscript><link rel="stylesheet" href="../noscript.css"></noscript><link rel="alternate icon" type="image/png" href="../favicon-16x16.png"><link rel="alternate icon" type="image/png" href="../favicon-32x32.png"><link rel="icon" type="image/svg+xml" href="../favicon.svg"><style type="text/css">#crate-search{background-image:url("../down-arrow.svg");}</style></head><body class="rustdoc type"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="sidebar"><div class="sidebar-menu" role="button">&#9776;</div><a href='../libnghttp2_sys/index.html'><div class='logo-container rust-logo'><img src='../rust-logo.png' alt='logo'></div></a><h2 class="location">Type Definition nghttp2_on_header_callback</h2><div class="sidebar-elems"><h2 class="location">Other items in<br><a href="index.html">libnghttp2_sys</a></h2><div id="sidebar-vars" data-name="nghttp2_on_header_callback" data-ty="type" data-relpath=""></div><script defer src="sidebar-items.js"></script></div></nav><div class="theme-picker"><button id="theme-picker" aria-label="Pick another theme!" aria-haspopup="menu" title="themes"><img width="18" height="18" alt="Pick another theme!" src="../brush.svg"></button><div id="theme-choices" role="menu"></div></div><nav class="sub"><form class="search-form"><div class="search-container"><div><select id="crate-search"><option value="All crates">All crates</option></select><input class="search-input" name="search" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"></div><button type="button" id="help-button" title="help">?</button><a id="settings-menu" href="../settings.html" title="settings"><img width="18" height="18" alt="Change settings" src="../wheel.svg"></a></div></form></nav><section id="main" class="content"><h1 class="fqn"><span class="in-band">Type Definition <a href="index.html">libnghttp2_sys</a>::<wbr><a class="type" href="#">nghttp2_on_header_callback</a><button id="copy-path" onclick="copy_path(this)" title="Copy item path to clipboard"><img src="../clipboard.svg" width="19" height="18" alt="Copy item path"></button></span><span class="out-of-band"><span id="render-detail"><a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">[<span class="inner">&#x2212;</span>]</a></span><a class="srclink" href="../src/libnghttp2_sys/lib.rs.html#1158-1169" title="goto source code">[src]</a></span></h1><div class="docblock item-decl"><pre class="rust typedef"><code>pub type nghttp2_on_header_callback = <a class="enum" href="https://doc.rust-lang.org/1.58.1/core/option/enum.Option.html" title="enum core::option::Option">Option</a>&lt;unsafe extern &quot;C&quot; <a class="primitive" href="https://doc.rust-lang.org/1.58.1/std/primitive.fn.html">fn</a>(session: <a class="primitive" href="https://doc.rust-lang.org/1.58.1/std/primitive.pointer.html">*mut </a><a class="struct" href="struct.nghttp2_session.html" title="struct libnghttp2_sys::nghttp2_session">nghttp2_session</a>, frame: <a class="primitive" href="https://doc.rust-lang.org/1.58.1/std/primitive.pointer.html">*const </a><a class="union" href="union.nghttp2_frame.html" title="union libnghttp2_sys::nghttp2_frame">nghttp2_frame</a>, name: <a class="primitive" href="https://doc.rust-lang.org/1.58.1/std/primitive.pointer.html">*const </a><a class="primitive" href="https://doc.rust-lang.org/1.58.1/std/primitive.u8.html">u8</a>, namelen: <a class="primitive" href="https://doc.rust-lang.org/1.58.1/std/primitive.usize.html">usize</a>, value: <a class="primitive" href="https://doc.rust-lang.org/1.58.1/std/primitive.pointer.html">*const </a><a class="primitive" href="https://doc.rust-lang.org/1.58.1/std/primitive.u8.html">u8</a>, valuelen: <a class="primitive" href="https://doc.rust-lang.org/1.58.1/std/primitive.usize.html">usize</a>, flags: <a class="primitive" href="https://doc.rust-lang.org/1.58.1/std/primitive.u8.html">u8</a>, user_data: <a class="primitive" href="https://doc.rust-lang.org/1.58.1/std/primitive.pointer.html">*mut </a><a class="enum" href="https://doc.rust-lang.org/1.58.1/core/ffi/enum.c_void.html" title="enum core::ffi::c_void">c_void</a>) -&gt; <a class="type" href="https://doc.rust-lang.org/1.58.1/std/os/raw/type.c_int.html" title="type std::os::raw::c_int">c_int</a>&gt;;</code></pre></div><details class="rustdoc-toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>@functypedef</p>
<p>Callback function invoked when a header name/value pair is received
for the |frame|.  The |name| of length |namelen| is header name.
The |value| of length |valuelen| is header value.  The |flags| is
bitwise OR of one or more of :type:<code>nghttp2_nv_flag</code>.</p>
<p>If :enum:<code>NGHTTP2_NV_FLAG_NO_INDEX</code> is set in |flags|, the receiver
must not index this name/value pair when forwarding it to the next
hop.  More specifically, “Literal Header Field never Indexed”
representation must be used in HPACK encoding.</p>
<p>When this callback is invoked, <code>frame-&gt;hd.type</code> is either
:enum:<code>NGHTTP2_HEADERS</code> or :enum:<code>NGHTTP2_PUSH_PROMISE</code>.  After all
header name/value pairs are processed with this callback, and no
error has been detected, :type:<code>nghttp2_on_frame_recv_callback</code>
will be invoked.  If there is an error in decompression,
:type:<code>nghttp2_on_frame_recv_callback</code> for the |frame| will not be
invoked.</p>
<p>Both |name| and |value| are guaranteed to be NULL-terminated.  The
|namelen| and |valuelen| do not include terminal NULL.  If
<code>nghttp2_option_set_no_http_messaging()</code> is used with nonzero
value, NULL character may be included in |name| or |value| before
terminating NULL.</p>
<p>Please note that unless <code>nghttp2_option_set_no_http_messaging()</code> is
used, nghttp2 library does perform validation against the |name|
and the |value| using <code>nghttp2_check_header_name()</code> and
<code>nghttp2_check_header_value()</code>.  In addition to this, nghttp2
performs validation based on HTTP Messaging rule, which is briefly
explained in :ref:<code>http-messaging</code> section.</p>
<p>If the application uses <code>nghttp2_session_mem_recv()</code>, it can return
:enum:<code>NGHTTP2_ERR_PAUSE</code> to make <code>nghttp2_session_mem_recv()</code>
return without processing further input bytes.  The memory pointed
by |frame|, |name| and |value| parameters are retained until
<code>nghttp2_session_mem_recv()</code> or <code>nghttp2_session_recv()</code> is called.
The application must retain the input bytes which was used to
produce these parameters, because it may refer to the memory region
included in the input bytes.</p>
<p>Returning :enum:<code>NGHTTP2_ERR_TEMPORAL_CALLBACK_FAILURE</code> will close
the stream (promised stream if frame is PUSH_PROMISE) by issuing
RST_STREAM with :enum:<code>NGHTTP2_INTERNAL_ERROR</code>.  In this case,
:type:<code>nghttp2_on_header_callback</code> and
:type:<code>nghttp2_on_frame_recv_callback</code> will not be invoked.  If a
different error code is desirable, use
<code>nghttp2_submit_rst_stream()</code> with a desired error code and then
return :enum:<code>NGHTTP2_ERR_TEMPORAL_CALLBACK_FAILURE</code>.  Again, use
<code>frame-&gt;push_promise.promised_stream_id</code> as stream_id parameter
in <code>nghttp2_submit_rst_stream()</code> if frame is PUSH_PROMISE.</p>
<p>The implementation of this function must return 0 if it succeeds.
It may return :enum:<code>NGHTTP2_ERR_PAUSE</code> or
:enum:<code>NGHTTP2_ERR_TEMPORAL_CALLBACK_FAILURE</code>.  For other critical
failures, it must return :enum:<code>NGHTTP2_ERR_CALLBACK_FAILURE</code>.  If
the other nonzero value is returned, it is treated as
:enum:<code>NGHTTP2_ERR_CALLBACK_FAILURE</code>.  If
:enum:<code>NGHTTP2_ERR_CALLBACK_FAILURE</code> is returned,
<code>nghttp2_session_recv()</code> and <code>nghttp2_session_mem_recv()</code> functions
immediately return :enum:<code>NGHTTP2_ERR_CALLBACK_FAILURE</code>.</p>
<p>To set this callback to :type:<code>nghttp2_session_callbacks</code>, use
<code>nghttp2_session_callbacks_set_on_header_callback()</code>.</p>
<p>.. warning::</p>
<p>Application should properly limit the total buffer size to store
incoming header fields.  Without it, peer may send large number
of header fields or large header fields to cause out of memory in
local endpoint.  Due to how HPACK works, peer can do this
effectively without using much memory on their own.</p>
</div></details></section><section id="search" class="content hidden"></section><div id="rustdoc-vars" data-root-path="../" data-current-crate="libnghttp2_sys" data-search-index-js="../search-index.js" data-search-js="../search.js"></div>
</body></html>